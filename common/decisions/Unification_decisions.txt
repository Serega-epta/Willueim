@unification_start_date = 2200.1.1 #2027.1.1
Unification_campaign = {
	peaceful_unification_campaign = {
		target_root_trigger = {
			#visible doesn`t disable available trigger
			hidden_trigger = {
				has_country_flag = Unification_campaign_flag
			}
		}
		target_array = neighbors_owned
		target_trigger = {
			FROM = {
				NOT = {
					has_war_with = ROOT
					tag = SIL #TODO
					tag = LWV #TODO
					has_country_flag = anschluss_denied_@ROOT
				}
				has_government = ROOT
				fighting_army_strength_ratio = {
					tag = ROOT
					ratio < 0.5
				}
				unification_campaign_allowed = yes
			}
		}
		cost = 50
		days_remove = 30
		remove_effect = {
			FROM = {
				country_event = {
					id = unification_negotiations.1
				}
			}
		}
		ai_will_do = {
			#bots will follow the scenario
			base = 50
		}
	}
	ultimatum_campaign = {
		target_root_trigger = {
			#visible doesn`t disable available trigger
			hidden_trigger = {
				has_country_flag = Unification_campaign_flag
			}
		}
		target_array = neighbors_owned
		target_trigger = {
			FROM = {
				fighting_army_strength_ratio = {
					tag = ROOT
					ratio < 0.5
				}
				NOT = {
					has_war_with = ROOT
					tag = SIL #TODO
					tag = LWV #TODO
				}
				OR = {
					NOT = {
						has_government = ROOT
					}
					has_country_flag = anschluss_denied_@ROOT
				}
				unification_campaign_allowed = yes
			}
		}
		cost = 75
		war_with_on_remove = FROM
		days_remove = 20
		complete_effect = {
			#prepare for war
			hidden_effect = {
				add_ai_strategy = {
					type = prepare_for_war
					id = FROM
					value = 200
				}
				FROM = {
					add_ai_strategy = {
						type = prepare_for_war
						id = ROOT
						value = 200
					}
				}
			}
		}
		remove_effect = {
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
		ai_will_do = {
			#bots will follow the scenario
			base = 10
			modifier = {
				FROM = {
					has_war = yes
				}
				factor = 2
			}
			modifier = {
				OR = {
					check_variable = {
						#just prevent batle royal
						random < 0.996
					}
					has_war = yes
					has_decision = ultimatum_campaign
				}
				factor = 0
			}
		}
	}



    Finnish_Unification_campaign = {
		available = {
			all_other_country = {
				OR = {
					tag = BLS
					is_subject_of = ROOT
				}
			}
		}
		cost = 100
		fire_only_once = yes
		complete_effect = {
			set_country_flag = Unification_flag
			remove_ideas = Time_goes_by
			add_dynamic_modifier = {
				modifier = Motherland_Then_now_henceforth
			}
			set_variable = {
    			var = monthly_population_var
    			value = -0.9
			}
			set_variable = {
    			var = production_speed_industrial_complex_factor_var
    			value = 0.5
			}
			set_variable = {
    			var = production_speed_infrastructure_factor_var
    			value = 0.5
			}
			set_variable = {
    			var = required_garrison_factor_var
    			value = -0.7
			}
			set_variable = {
    			var = weekly_manpower_var
    			value = -1000
			}
			set_variable = {
    			var = compliance_growth_on_our_occupied_states_var
    			value = 0.6
			}
			set_variable = {
    			var = red_forest_expiditions
    			value = 1
			}
		}
		ai_will_do = {
			#bots will follow the scenario
			base = 0
			#but... if there is 2027 - we should hurry (unification)
			modifier = {
				date > @unification_start_date
				add = 1000
			}
		}
	}
}

Unification = {
	city_restoration = {
		priority = 1000
		targets = {
			12		#Vidzeme
			219		#Moscow
			249		#Kazan
			260		#Voronez
			1001	#Ufa
		}
		available = {
			num_of_civilian_factories_available_for_projects > 19
			controls_state = FROM
			FROM = {
				filtration_station > 0
			}
		}
		target_root_trigger = {
			#has_country_flag = Unification_flag
		}
		target_trigger = {
			FROM = {
				NOT = {
					has_state_flag = city_restored
				}
			}
		}
		state_target = yes
		cost = 120
		days_remove = 1
		modifier = {
			civilian_factory_use = 20
		}
		remove_effect = {
			custom_effect_tooltip = change_Motherland_tt
			add_to_variable = {
				global.monthly_population_var = 0.24
				tooltip = monthly_population_tt
			}
			FROM = {
				#if for tooltip
				if = {
					limit = {
						state = 219 #Москва
						is_capital = no
					}
					ROOT = {
						set_capital = {
							state = PREV
						}
					}
				}
				if = {
					limit = {
						infrastructure < 5
					}
					set_building_level = {
						type = infrastructure
						level = 5
						instant_build = yes
					}
				}
				custom_override_tooltip = {
					tooltip = unlock_all_building_slots_tt
					add_extra_state_shared_building_slots = 25
				}
				custom_override_tooltip = {
					tooltip = repair_all_shared_buildings_tt
					fix_all_shared_building = yes
				}
				add_dynamic_modifier = {
					modifier = city_restored
					days = 180
				}
				set_state_flag = city_restored
			}
			add_to_array = {
				global.city_restored_array = FROM
			}
			unite_motherland = yes
		}
	}
	communication_restoration = {
		priority = 800
		targets = {
			12		#Vidzeme
			219		#Moscow
			249		#Kazan
			260		#Voronez
			1001	#Ufa
			#special
			195		#Leningrade
			#non-strategic restoration
			202		#Kyiv
			206		#Minsk
			252		#Gorky
			398		#Perm
			833		#Yoshkar-Ola
			843		#Sevastopol
			997		#Vyatka
		}
		available = {
			num_of_civilian_factories_available_for_projects > 9
			controls_state = FROM
			radar_station > 0
		}
		target_root_trigger = {
			#has_country_flag = Unification_flag
		}
		target_trigger = {
			FROM = {
				NOT = {
					has_state_flag = communication_restored
				}
			}
		}
		state_target = yes
		cost = 25
		days_remove = 20
		modifier = {
			civilian_factory_use = 10
		}
		remove_effect = {
			FROM = {
				set_state_flag = communication_restored
				add_building_construction = {
					type = radar_station
    				level = 3
    				instant_build = yes
				}
			}
			add_to_array = {
				global.communication_restored_array = FROM
			}
			unite_motherland = yes
		}
	}
	city_garrison = {
		priority = 900
		targets = {
			12		#Vidzeme
			219		#Moscow
			249		#Kazan
			260		#Voronez
			1001	#Ufa
			#special
			195		#Leningrade
		}
		state_target = yes
		available = {
			controls_state = FROM
			set_temp_variable = {
				div_num = FROM.state_population_k
			}
			multiply_temp_variable = {
				div_num = 0.025
			}
			#divisions_in_state can`t accept temp variable in size
			meta_trigger = {
				text = {
					divisions_in_state = {
						size > [N]
						state = FROM
					}
				}
				N = "[?div_num]"
			}
		}
		target_root_trigger = {
			#has_country_flag = Unification_flag
		}
		target_trigger = {
			FROM = {
				#no need for guarding ruins
				#has_state_flag = city_restored
				NOT = {
					has_state_flag = city_garrison_set
				}
			}
		}
		cost = 25
		days_remove = 20
		modifier = {
			production_factory_max_efficiency_factor = -0.1
		}
		remove_effect = {
			custom_effect_tooltip = change_Motherland_tt
			add_to_variable = {
				global.weekly_manpower_var = 500
				tooltip = weekly_manpower_tt
			}
			FROM = {
				set_state_flag = city_garrison_set
			}
			add_to_array = {
				global.city_garrison_array = FROM
			}
			unite_motherland = yes
		}
	}
	#Special for Leningrade
	operation_nevsky = {
		priority = 999
		targets = { 195 }
		state_target = yes
		fire_only_once = yes
		cost = 250
		days_remove = 2
		available = {
			custom_trigger_tooltip = {
				tooltip = cities_restored_num_3_or_bigger_tt
				check_variable = {
					global.city_restored_array^num > 2
				}
			}
		}
		target_root_trigger = {
			#has_country_flag = Unification_flag
		}
		modifier = {
			civilian_factory_use = 50
		}
		remove_effect = {
			custom_effect_tooltip = change_Motherland_tt
			add_to_variable = {
				global.monthly_population_var = 0.24
				tooltip = monthly_population_tt
			}
			FROM = {
				custom_override_tooltip = {
					tooltip = {
						localization_key = city_resettlement_tt
						NUM = 50000
					}
					for_each_scope_loop = {
						array = ROOT.city_restored_array
						add_manpower = -50000
						PREV = {
							add_manpower = 50000
						}
					}
				}
				if = {
					limit = {
						infrastructure < 5
					}
					set_building_level = {
						type = infrastructure
						level = 5
						instant_build = yes
					}
				}
				custom_override_tooltip = {
					tooltip = unlock_all_building_slots_tt
					add_extra_state_shared_building_slots = 25
				}
				custom_override_tooltip = {
					tooltip = repair_all_shared_buildings_tt
					fix_all_shared_building = yes
				}
				add_dynamic_modifier = {
					modifier = city_restored
					days = 180
				}
				set_state_flag = city_restored
			}
			add_to_array = {
				global.city_restored_array = FROM
			}
			unite_motherland = yes
		}
		#must be at the end of decisions!
		finish_unification = yes
	}
	reanimate_civil_industry = {
		fire_only_once = yes
		cost = 500
		days_remove = 360
		available = {
			hidden_trigger = {
				#has_country_flag = Unification_flag
			}
			num_of_civilian_factories_available_for_projects > 49
		}
		modifier = {
			civilian_factory_use = 50
		}
		remove_effect = {
			every_controlled_state = {
				limit = {
					industrial_complex < 1
				}
				add_extra_state_shared_building_slots = 1
				add_building_construction = {
					type = industrial_complex
					level = 1
					instant_build = yes
				}
				if = {
					limit = {			
						infrastructure < 1
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			set_global_flag = civil_industry_reanimated
			unite_motherland = yes
		}
	}
	new_railway_system_moscow = {
		fire_only_once = yes
		cost = 50
		days_remove = 30
		available = {
			hidden_trigger = {
				#has_country_flag = Unification_flag
			}
			num_of_civilian_factories_available_for_projects > 4
			has_full_control_of_state = 219
		}
		modifier = {
			civilian_factory_use = 5
		}
		remove_effect = {
			build_railway = {
				level = 5
				path = { 3259 6380 6414 9348 }
			}
			build_railway = {
				level = 5
				path = { 6380 3391 3327 3263 382 }
			}
			add_to_variable = {
				global.railway_system_num = 1
			}
			unite_motherland = yes
		}
	}
	water_purification = {
		fire_only_once = yes
		cost = 500
		days_remove = 90
		available = {
			hidden_trigger = {
				#has_country_flag = Unification_flag
			}
			custom_trigger_tooltip = {
				tooltip = no_red_forest_allowed_tt
				check_variable = {
					global.red_forest_corruption^num = 0
				}
			}
			has_built = {
				type = filtration_station
				value > 10
			}
			num_of_civilian_factories_available_for_projects > 49
		}
		modifier = {
			civilian_factory_use = 50
		}
		remove_effect = {
			set_global_flag = water_purified
			unite_motherland = yes
		}
	}
}
red_forest_category = {
	clear_red_forest = {
		target_array = global.red_forest_corruption
		state_target = yes
	}
}