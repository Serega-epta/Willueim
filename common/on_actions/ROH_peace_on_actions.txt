on_actions = {
	on_capitulation = {
		effect = {
			FROM = {
				save_global_event_target_as = winning_country
			}
			ROOT = {
				save_global_event_target_as = losing_country
			}
			
			if = {
				limit = {
					OR = {
						ROOT = { is_in_faction = no }
						ROOT = {
							all_allied_country = {
								has_capitulated = yes
							}
						}
					}
				}
				if = {
					limit = { NOT = { has_global_flag = skip_default_capitulation } }
					FROM = {
						every_enemy_country = {
							limit = {
								OR = {
									original_tag = ROOT
									is_in_faction_with = ROOT
									is_puppet_of = ROOT
								}
							}
							FROM = {
								white_peace = PREV
								annex_country = {
									target = PREV
									transfer_troops = no
								}
							}
						}
					}
				}
			}
		}
	}
}